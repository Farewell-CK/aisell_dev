# å¼€åœºç™½ç”ŸæˆæœåŠ¡ API æ–‡æ¡£

## æ¦‚è¿°

å¼€åœºç™½ç”ŸæˆæœåŠ¡æä¾›æ™ºèƒ½å¼€åœºç™½å’Œé—®å€™è¯­ç”ŸæˆåŠŸèƒ½ï¼Œæ”¯æŒä¸ªæ€§åŒ–å¼€åœºç™½ã€èŠ‚æ—¥é—®å€™ã€å®¢æˆ·ç»´æŠ¤æ¶ˆæ¯ç­‰å¤šç§åœºæ™¯ã€‚

## æœåŠ¡ä¿¡æ¯

- **æœåŠ¡åç§°**: å¼€åœºç™½ç”ŸæˆæœåŠ¡
- **ç«¯å£**: æ ¹æ®å¯åŠ¨è„šæœ¬é…ç½®
- **åè®®**: HTTP/HTTPS
- **æ•°æ®æ ¼å¼**: JSON

## API ç«¯ç‚¹

### 1. ç”Ÿæˆä¸ªæ€§åŒ–å¼€åœºç™½

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `POST`
- **è·¯å¾„**: `/generate/personalized`
- **æè¿°**: æ ¹æ®å®¢æˆ·ä¿¡æ¯å’Œå…¬å¸èµ„æ–™ç”Ÿæˆä¸ªæ€§åŒ–å¼€åœºç™½

#### è¯·æ±‚å‚æ•°

**è¯·æ±‚ä½“** (JSON):
```json
{
  "tenant_id": "string",           // ç§Ÿæˆ·IDï¼Œå¿…å¡«
  "task_id": "string",             // ä»»åŠ¡IDï¼Œå¿…å¡«
  "wechat_id": "string"            // å®¢æˆ·å¾®ä¿¡IDï¼Œå¿…å¡«
}
```

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "tenant_id": "string",
  "task_id": "string",
  "status": "success",
  "message": ["å¼€åœºç™½1", "å¼€åœºç™½2", "å¼€åœºç™½3"]
}
```

**é”™è¯¯å“åº”** (400/500):
```json
{
  "status": "error",
  "message": "é”™è¯¯æè¿°"
}
```

#### ç¤ºä¾‹

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost:8000/generate/personalized" \
  -H "Content-Type: application/json" \
  -d '{
    "tenant_id": "tenant_001",
    "task_id": "task_001",
    "wechat_id": "customer_001"
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "tenant_id": "tenant_001",
  "task_id": "task_001",
  "status": "success",
  "message": [
    "æ‚¨å¥½ï¼æˆ‘æ˜¯XXå…¬å¸çš„é”€å”®é¡¾é—®ï¼Œå¾ˆé«˜å…´è®¤è¯†æ‚¨ã€‚æˆ‘ä»¬å…¬å¸ä¸“æ³¨äºæä¾›é«˜è´¨é‡çš„è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›èƒ½ä¸ºæ‚¨å¸¦æ¥ä»·å€¼ã€‚",
    "Hiï¼æˆ‘æ˜¯XXå…¬å¸çš„ä¸“ä¸šé¡¾é—®ï¼Œçœ‹åˆ°æ‚¨çš„èµ„æ–™å¾ˆæ„Ÿå…´è¶£ã€‚æˆ‘ä»¬æœ‰å¾ˆå¤šæˆåŠŸæ¡ˆä¾‹ï¼Œæƒ³å’Œæ‚¨åˆ†äº«ä¸€ä¸‹ã€‚",
    "æ‚¨å¥½ï¼æˆ‘æ˜¯XXå…¬å¸çš„é”€å”®ä»£è¡¨ï¼Œæˆ‘ä»¬å…¬å¸åœ¨è¿™ä¸ªé¢†åŸŸæœ‰ä¸°å¯Œçš„ç»éªŒï¼Œå¸Œæœ›èƒ½ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„æœåŠ¡ã€‚"
  ]
}
```

### 2. ç”ŸæˆèŠ‚æ—¥é—®å€™

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `POST`
- **è·¯å¾„**: `/generate/festival_greeting`
- **æè¿°**: æ ¹æ®æŒ‡å®šæ—¥æœŸç”ŸæˆèŠ‚æ—¥é—®å€™è¯­

#### è¯·æ±‚å‚æ•°

**è¯·æ±‚ä½“** (JSON):
```json
{
  "date": "2024-06-10",           // æ—¥æœŸï¼Œæ ¼å¼ï¼šYYYY-MM-DDï¼Œå¿…å¡«
  "tenant_id": "string",           // ç§Ÿæˆ·IDï¼Œå¿…å¡«
  "task_id": "string",             // ä»»åŠ¡IDï¼Œå¿…å¡«
  "wechat_id": "string"            // å®¢æˆ·å¾®ä¿¡IDï¼Œå¿…å¡«
}
```

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "status": "success",
  "festival": "ç«¯åˆèŠ‚",
  "greetings": [
    "ç«¯åˆèŠ‚å¿«ä¹ï¼ç¥æ‚¨èº«ä½“å¥åº·ï¼Œä¸‡äº‹å¦‚æ„ï¼",
    "ç«¯åˆå®‰åº·ï¼æ„¿æ‚¨åœ¨è¿™ä¸ªä¼ ç»Ÿä½³èŠ‚é‡Œé˜–å®¶æ¬¢ä¹ï¼",
    "ç¥æ‚¨ç«¯åˆèŠ‚å¿«ä¹ï¼Œç²½å­é¦™ç”œï¼Œç”Ÿæ´»ç¾æ»¡ï¼"
  ]
}
```

#### ç¤ºä¾‹

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost:8000/generate/festival_greeting" \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2024-06-10",
    "tenant_id": "tenant_001",
    "task_id": "task_001",
    "wechat_id": "customer_001"
  }'
```

### 3. ç”Ÿæˆå®¢æˆ·ç»´æŠ¤æ¶ˆæ¯

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `POST`
- **è·¯å¾„**: `/generate/customer_maintenance`
- **æè¿°**: ç”Ÿæˆå®¢æˆ·ç»´æŠ¤å’Œå…³æ€€æ¶ˆæ¯

#### è¯·æ±‚å‚æ•°

**è¯·æ±‚ä½“** (JSON):
```json
{
  "tenant_id": "string",           // ç§Ÿæˆ·IDï¼Œå¿…å¡«
  "task_id": "string"              // ä»»åŠ¡IDï¼Œå¿…å¡«
}
```

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "status": "success",
  "messages": [
    "æœ€è¿‘å·¥ä½œè¿˜é¡ºåˆ©å—ï¼Ÿæœ‰ä»€ä¹ˆéœ€è¦å¸®åŠ©çš„åœ°æ–¹éšæ—¶è”ç³»æˆ‘ã€‚",
    "æ„Ÿè°¢æ‚¨ä¸€ç›´ä»¥æ¥çš„ä¿¡ä»»å’Œæ”¯æŒï¼Œæˆ‘ä»¬ä¼šç»§ç»­ä¸ºæ‚¨æä¾›ä¼˜è´¨æœåŠ¡ã€‚",
    "å¸Œæœ›æˆ‘ä»¬çš„äº§å“èƒ½ä¸ºæ‚¨å¸¦æ¥ä»·å€¼ï¼Œå¦‚æœ‰ä»»ä½•é—®é¢˜è¯·éšæ—¶å’¨è¯¢ã€‚"
  ]
}
```

#### ç¤ºä¾‹

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost:8000/generate/customer_maintenance" \
  -H "Content-Type: application/json" \
  -d '{
    "tenant_id": "tenant_001",
    "task_id": "task_001"
  }'
```

### 4. ç”Ÿæˆå¾®ä¿¡é—®å€™è¯­

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `POST`
- **è·¯å¾„**: `/generate/wechat_greeting`
- **æè¿°**: ç”Ÿæˆå¾®ä¿¡é£æ ¼çš„é—®å€™è¯­

#### è¯·æ±‚å‚æ•°

**è¯·æ±‚ä½“** (JSON):
```json
{
  "tenant_id": "string",           // ç§Ÿæˆ·IDï¼Œå¿…å¡«
  "task_id": "string",             // ä»»åŠ¡IDï¼Œå¿…å¡«
  "wechat_id": "string"            // å®¢æˆ·å¾®ä¿¡IDï¼Œå¿…å¡«
}
```

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "status": "success",
  "messages": [
    "ğŸ‘‹ æ‚¨å¥½ï¼å¾ˆé«˜å…´è®¤è¯†æ‚¨ï¼",
    "ğŸ˜Š å¸Œæœ›æˆ‘ä»¬çš„äº§å“èƒ½ä¸ºæ‚¨å¸¦æ¥å¸®åŠ©ï¼",
    "ğŸ’¼ ä¸“ä¸šæœåŠ¡ï¼Œå€¼å¾—ä¿¡èµ–ï¼"
  ]
}
```

#### ç¤ºä¾‹

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST "http://localhost:8000/generate/wechat_greeting" \
  -H "Content-Type: application/json" \
  -d '{
    "tenant_id": "tenant_001",
    "task_id": "task_001",
    "wechat_id": "customer_001"
  }'
```

### 5. æœåŠ¡æ ¹è·¯å¾„

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `GET`
- **è·¯å¾„**: `/`
- **æè¿°**: è·å–æœåŠ¡ä¿¡æ¯å’Œå¯ç”¨ç«¯ç‚¹

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "message": "å¼€åœºç™½ç”ŸæˆæœåŠ¡",
  "version": "1.0.0",
  "endpoints": [
    "/generate/personalized",
    "/generate/festival_greeting",
    "/generate/customer_maintenance",
    "/generate/wechat_greeting"
  ]
}
```

### 6. å¥åº·æ£€æŸ¥

#### è¯·æ±‚ä¿¡æ¯
- **æ–¹æ³•**: `GET`
- **è·¯å¾„**: `/health`
- **æè¿°**: æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€

#### å“åº”å‚æ•°

**æˆåŠŸå“åº”** (200):
```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00Z",
  "service": "å¼€åœºç™½ç”ŸæˆæœåŠ¡"
}
```

## æ”¯æŒçš„èŠ‚æ—¥ç±»å‹

### ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥
- æ˜¥èŠ‚ (å†œå†æ­£æœˆåˆä¸€)
- å…ƒå®µèŠ‚ (å†œå†æ­£æœˆåäº”)
- æ¸…æ˜èŠ‚ (å…¬å†4æœˆ5æ—¥å‰å)
- ç«¯åˆèŠ‚ (å†œå†äº”æœˆåˆäº”)
- ä¸­ç§‹èŠ‚ (å†œå†å…«æœˆåäº”)
- é‡é˜³èŠ‚ (å†œå†ä¹æœˆåˆä¹)

### å›½é™…èŠ‚æ—¥
- å…ƒæ—¦ (1æœˆ1æ—¥)
- æƒ…äººèŠ‚ (2æœˆ14æ—¥)
- å¦‡å¥³èŠ‚ (3æœˆ8æ—¥)
- åŠ³åŠ¨èŠ‚ (5æœˆ1æ—¥)
- å„¿ç«¥èŠ‚ (6æœˆ1æ—¥)
- æ•™å¸ˆèŠ‚ (9æœˆ10æ—¥)
- å›½åº†èŠ‚ (10æœˆ1æ—¥)
- åœ£è¯èŠ‚ (12æœˆ25æ—¥)

## ä¸ªæ€§åŒ–å¼€åœºç™½ç‰¹ç‚¹

### 1. åŸºäºå®¢æˆ·ç”»åƒ
- æ ¹æ®å®¢æˆ·è¡Œä¸šç‰¹ç‚¹å®šåˆ¶
- è€ƒè™‘å®¢æˆ·å…¬å¸è§„æ¨¡
- ç»“åˆå®¢æˆ·å†å²è¡Œä¸º

### 2. åŸºäºäº§å“ä¿¡æ¯
- çªå‡ºäº§å“ä¼˜åŠ¿
- å¼ºè°ƒè§£å†³æ–¹æ¡ˆä»·å€¼
- æä¾›ç›¸å…³æ¡ˆä¾‹

### 3. åŸºäºé”€å”®ç­–ç•¥
- ä¸åŒé˜¶æ®µçš„é”€å”®è¯æœ¯
- é’ˆå¯¹æ€§çš„ä»·å€¼ä¸»å¼ 
- ä¸ªæ€§åŒ–çš„æœåŠ¡æ‰¿è¯º


## æœ€ä½³å®è·µ

### 1. å¼€åœºç™½ä½¿ç”¨å»ºè®®
- **ä¸ªæ€§åŒ–å¼€åœºç™½**: ç”¨äºåˆæ¬¡æ¥è§¦å®¢æˆ·
- **èŠ‚æ—¥é—®å€™**: åœ¨èŠ‚æ—¥æœŸé—´ä¸»åŠ¨å…³æ€€
- **å®¢æˆ·ç»´æŠ¤**: å®šæœŸç»´æŠ¤å®¢æˆ·å…³ç³»
- **å¾®ä¿¡é—®å€™**: é€‚åˆå¾®ä¿¡èŠå¤©åœºæ™¯

### 2. è°ƒç”¨é¢‘ç‡æ§åˆ¶
- é¿å…é¢‘ç¹è°ƒç”¨ç›¸åŒå‚æ•°
- å»ºè®®é—´éš”è‡³å°‘1åˆ†é’Ÿ
