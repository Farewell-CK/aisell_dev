2025-06-25 22:31:27,080 - INFO - file_description - __init__ - 59 - TextSummarizer 初始化完成。Chunk size: 4000, Overlap size: 200
2025-06-25 22:31:27,122 - INFO - file_description - __init__ - 322 - ImageSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-8k-preview
2025-06-25 22:31:27,163 - INFO - file_description - __init__ - 550 - TableSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3
2025-06-25 22:31:27,204 - INFO - file_description - __init__ - 914 - PPTSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-8k-preview
2025-06-25 22:31:27,204 - INFO - file_description - __init__ - 915 - 确保 LibreOffice (soffice) 已安装并在系统 PATH 中，以便支持 .ppt 文件转换。
2025-06-25 22:31:27,246 - INFO - file_description - __init__ - 1341 - DocumentSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-turbo-128k, Chunk Size: 4000, Overlap Size: 200
2025-06-25 22:31:27,246 - WARNING - file_description - __init__ - 1345 - 注意: 当前 summarize_document 方法会将整个提取的文档内容作为单个JSON字符串发送给LLM。即使 ernie-4.5-turbo-128k 支持长上下文，对于超大文档，将结构化JSON直接传入仍需注意实际token消耗和成本。类中定义的 chunk_size, overlap_size 和 split_text 方法目前未用于对提取的文档原始文本内容进行分块总结。如需更精细或成本优化的超长文档处理，请考虑修改 summarize_document 以实现基于原始文本的分块和可能的分层总结策略。
2025-06-25 22:31:27,287 - INFO - file_description - __init__ - 1831 - VideoSummarizer 初始化完成。API base_url: https://dashscope.aliyuncs.com/compatible-mode/v1, Model: qwen-vl-max-latest
2025-06-25 22:31:27,287 - WARNING - file_description - __init__ - 1832 - 当前版本主要支持通过 URL 处理视频。本地视频文件处理功能尚未完全实现。
2025-06-29 14:05:33,704 - INFO - file_description - __init__ - 59 - TextSummarizer 初始化完成。Chunk size: 4000, Overlap size: 200
2025-06-29 14:05:33,765 - INFO - file_description - __init__ - 322 - ImageSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-8k-preview
2025-06-29 14:05:33,805 - INFO - file_description - __init__ - 550 - TableSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3
2025-06-29 14:05:33,850 - INFO - file_description - __init__ - 914 - PPTSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-8k-preview
2025-06-29 14:05:33,850 - INFO - file_description - __init__ - 915 - 确保 LibreOffice (soffice) 已安装并在系统 PATH 中，以便支持 .ppt 文件转换。
2025-06-29 14:05:33,894 - INFO - file_description - __init__ - 1341 - DocumentSummarizer 初始化完成。API base_url: https://aistudio.baidu.com/llm/lmapi/v3/, Model: ernie-4.5-turbo-128k, Chunk Size: 4000, Overlap Size: 200
2025-06-29 14:05:33,894 - WARNING - file_description - __init__ - 1345 - 注意: 当前 summarize_document 方法会将整个提取的文档内容作为单个JSON字符串发送给LLM。即使 ernie-4.5-turbo-128k 支持长上下文，对于超大文档，将结构化JSON直接传入仍需注意实际token消耗和成本。类中定义的 chunk_size, overlap_size 和 split_text 方法目前未用于对提取的文档原始文本内容进行分块总结。如需更精细或成本优化的超长文档处理，请考虑修改 summarize_document 以实现基于原始文本的分块和可能的分层总结策略。
2025-06-29 14:05:33,938 - INFO - file_description - __init__ - 1831 - VideoSummarizer 初始化完成。API base_url: https://dashscope.aliyuncs.com/compatible-mode/v1, Model: qwen-vl-max-latest
2025-06-29 14:05:33,938 - WARNING - file_description - __init__ - 1832 - 当前版本主要支持通过 URL 处理视频。本地视频文件处理功能尚未完全实现。
2025-06-29 22:31:07,222 - INFO - file_description - summarize_table - 698 - 开始总结表格: /tmp/tmpuugpxin_.xls
2025-06-29 22:31:07,223 - INFO - file_description - read_table - 567 - 尝试读取表格源: /tmp/tmpuugpxin_.xls
2025-06-29 22:31:07,224 - INFO - file_description - read_table - 626 - 输入为本地文件路径: /tmp/tmpuugpxin_.xls
2025-06-29 22:31:07,224 - INFO - file_description - read_table - 628 - 本地文件格式: .xls
2025-06-29 22:31:07,226 - ERROR - file_description - read_table - 642 - 读取本地文件 '/tmp/tmpuugpxin_.xls' 出错: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
Traceback (most recent call last):
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'xlrd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/funhpc/workspace/aisell_dev/utils/file_description.py", line 631, in read_table
    df = pd.read_excel(file_path_or_url)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/site-packages/pandas/io/excel/_xlrd.py", line 45, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
  File "/home/funhpc/miniconda3/envs/adk/lib/python3.12/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2025-06-29 22:31:07,249 - WARNING - file_description - summarize_table - 701 - 无法读取或表格为空: /tmp/tmpuugpxin_.xls，总结中止。
